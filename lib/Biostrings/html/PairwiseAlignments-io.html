<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Write a PairwiseAlignments object to a file</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for PairwiseAlignments-io {Biostrings}"><tr><td>PairwiseAlignments-io {Biostrings}</td><td align="right">R Documentation</td></tr></table>

<h2>Write a PairwiseAlignments object to a file</h2>

<h3>Description</h3>

<p>The <code>writePairwiseAlignments</code> function writes a
<a href="PairwiseAlignments-class.html">PairwiseAlignments</a> object to a file.
Only the &quot;pair&quot; format is supported at the moment.
</p>


<h3>Usage</h3>

<pre>
writePairwiseAlignments(x, file="", Matrix=NA, block.width=50)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>

<p>A <a href="PairwiseAlignments-class.html">PairwiseAlignments</a> object, typically returned by the
<code><a href="pairwiseAlignment.html">pairwiseAlignment</a></code> function.
</p>
</td></tr>
<tr valign="top"><td><code>file</code></td>
<td>

<p>A connection, or a character string naming the file to print
to. If <code>""</code> (the default), <code>writePairwiseAlignments</code>
prints to the standard output connection (aka the console)
unless redirected by <code>sink</code>.
If it is <code>"|cmd"</code>, the output is piped to the command given
by <code>cmd</code>, by opening a pipe connection.
</p>
</td></tr>
<tr valign="top"><td><code>Matrix</code></td>
<td>

<p>A single string containing the name of the substitution matrix
(e.g. <code>"BLOSUM50"</code>) used for the alignment.
See the <code>substitutionMatrix</code> argument of the
<code><a href="pairwiseAlignment.html">pairwiseAlignment</a></code> function for the details.
See <code>?<a href="substitution_matrices.html">substitution.matrices</a></code> for a list of
predefined substitution matrices available in the Biostrings package.
</p>
</td></tr>
<tr valign="top"><td><code>block.width</code></td>
<td>

<p>A single integer specifying the maximum number of sequence
letters (including the &quot;-&quot; letter, which represents gaps)
per line.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;pair&quot; format is one of the numerous pairwise sequence alignment
formats supported by the EMBOSS software. See
<a href="http://emboss.sourceforge.net/docs/themes/AlignFormats.html">http://emboss.sourceforge.net/docs/themes/AlignFormats.html</a>
for a brief (and rather informal) description of this format.
</p>


<h3>Note</h3>

<p>This brief description of the &quot;pair&quot; format suggests that
it is best suited for <EM>global</EM> pairwise alignments,
because, in that case, the original pattern and subject sequences
can be inferred (by just removing the gaps).
</p>
<p>However, even though the &quot;pair&quot; format can also be used for non global
pairwise alignments (i.e. for <EM>global-local</EM>, <EM>local-global</EM>,
and <EM>local</EM> pairwise alignments), in that case the original
pattern and subject sequences <EM>cannot</EM> be inferred. This is because
the alignment written to the file doesn't necessarily span the entire
pattern (if <code>type(x)</code> is <code>local-global</code> or <code>local</code>)
or the entire subject (if <code>type(x)</code> is <code>global-local</code>
or <code>local</code>).
</p>
<p>As a consequence, the <code>writePairwiseAlignments</code> function can be
used on a <a href="PairwiseAlignments-class.html">PairwiseAlignments</a> object <code>x</code> containing non global
alignments (i.e. with <code>type(x) != "global"</code>), but with the 2 following
caveats:
</p>

<ol>
<li><p> The type of the alignments (<code>type(x)</code>) is not written
to the file.
</p>
</li>
<li><p> The original pattern and subject sequences cannot be inferred.
Furthermore, there is no way to infer their lengths (because
we don't know whether they were trimmed or not).
</p>
</li></ol>

<p>Also note that the <code><a href="pairwiseAlignment.html">pairwiseAlignment</a></code> function
interprets the <code>gapOpening</code> and <code>gapExtension</code> arguments
differently than most other alignment tools. As a consequence
the values of the Gap_penalty and Extend_penalty fields written to
the file are not the same as the values that were passed to the
<code>gapOpening</code> and <code>gapExtension</code> arguments. With the
following relationship:
</p>

<ul>
<li><p> Gap_penalty = - gapOpening - gapExtension
</p>
</li>
<li><p> Extend_penalty = - gapExtension
</p>
</li></ul>



<h3>Author(s)</h3>

<p>H. Pages
</p>


<h3>References</h3>

<p><a href="http://emboss.sourceforge.net/docs/themes/AlignFormats.html">http://emboss.sourceforge.net/docs/themes/AlignFormats.html</a>
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="pairwiseAlignment.html">pairwiseAlignment</a></code>
</p>
</li>
<li> <p><a href="PairwiseAlignments-class.html">PairwiseAlignments-class</a>
</p>
</li>
<li> <p><a href="substitution_matrices.html">substitution.matrices</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre>
## ---------------------------------------------------------------------
## A. WITH ONE PAIR
## ---------------------------------------------------------------------
pattern &lt;- DNAString("CGTACGTAACGTTCGT")
subject &lt;- DNAString("CGTCGTCGTCCGTAA")
x1 &lt;- pairwiseAlignment(pattern, subject)
x1
writePairwiseAlignments(x1)
writePairwiseAlignments(x1, block.width=10)
## The 2 bottom-right numbers (16 and 15) are the lengths of
## the original pattern and subject, respectively.

x2 &lt;- pairwiseAlignment(pattern, subject, type="global-local")
x2  # score is different!
writePairwiseAlignments(x2)
## By just looking at the file, we can't tell the length of the
## original subject! Could be 13, could be more...

## ---------------------------------------------------------------------
## B. WITH MORE THAN ONE PAIR (AND NAMED PATTERNS)
## ---------------------------------------------------------------------
pattern &lt;- DNAStringSet(c(myp1="ACCA", myp2="ACGCA", myp3="ACGGCA"))
x3 &lt;- pairwiseAlignment(pattern, subject)
x3
writePairwiseAlignments(x3)

## ---------------------------------------------------------------------
## C. REPRODUCING THE ALIGNMENT SHOWN AT
##    http://emboss.sourceforge.net/docs/themes/alnformats/align.pair
## ---------------------------------------------------------------------
pattern &lt;- c("TSPASIRPPAGPSSRPAMVSSRRTRPSPPGPRRPTGRPCCSAAPRRPQAT",
             "GGWKTCSGTCTTSTSTRHRGRSGWSARTTTAACLRASRKSMRAACSRSAG",
             "SRPNRFAPTLMSSCITSTTGPPAWAGDRSHE")
subject &lt;- c("TSPASIRPPAGPSSRRPSPPGPRRPTGRPCCSAAPRRPQATGGWKTCSGT",
             "CTTSTSTRHRGRSGWRASRKSMRAACSRSAGSRPNRFAPTLMSSCITSTT",
             "GPPAWAGDRSHE")
pattern &lt;- unlist(AAStringSet(pattern))
subject &lt;- unlist(AAStringSet(subject))
pattern  # original pattern
subject  # original subject
data(BLOSUM62)
x4 &lt;- pairwiseAlignment(pattern, subject,
                        substitutionMatrix=BLOSUM62,
                        gapOpening=-9.5, gapExtension=-0.5)
x4
writePairwiseAlignments(x4, Matrix="BLOSUM62")
</pre>

<hr><div align="center">[Package <em>Biostrings</em> version 2.32.0 <a href="00Index.html">Index</a>]</div>
</body></html>
